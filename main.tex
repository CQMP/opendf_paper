%% The '3p' and 'times' class options of elsarticle are used for Elsevier CRC
%% The 'procedia' option causes ecrc to approximate to the Word template
\documentclass[3p,times,procedia]{elsarticle}
\flushbottom

%% The `ecrc' package must be called to make the CRC functionality available
\usepackage{ecrc}
\usepackage[colorlinks=true]{hyperref}%url}
\usepackage{amsmath}

\newcommand{\andrey}[1]{\textcolor{blue}{#1}}
\newcommand{\emanuel}[1]{\textbf{\color{CarnationPink}#1}}


%% The ecrc package defines commands needed for running heads and logos.
%% For running heads, you can set the journal name, the volume, the starting page and the authors

%% set the volume if you know. Otherwise `00'
\volume{00}

%% set the starting page if not 1
\firstpage{1}

%% Give the name of the journal
\journalname{Physics Procedia}

%% Give the author list to appear in the running head
%% Example \runauth{C.V. Radhakrishnan et al.}
\runauth{A. E. Antipov et al.}

%% The choice of journal logo is determined by the \jid and \jnltitlelogo commands.
%% A user-supplied logo with the name <\jid>logo.pdf will be inserted if present.
%% e.g. if \jid{yspmi} the system will look for a file yspmilogo.pdf
%% Otherwise the content of \jnltitlelogo will be set between horizontal lines as a default logo

%% Give the abbreviation of the Journal.
\jid{phpro}

%% Give a short journal name for the dummy logo (if needed)
\jnltitlelogo{Physics Procedia}


\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
\biboptions{authoryear}

% \biboptions{}

% if you have landscape tables
\usepackage[figuresright]{rotating}
%\usepackage{harvard}
% put your own definitions here:x
%   \newcommand{\cZ}{\cal{Z}}
%   \newtheorem{def}{Definition}[section]
%   ...

% add words to TeX's hyphenation exception list
%\hyphenation{author another created financial paper re-commend-ed Post-Script}

% declarations for front matter

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\dochead{28th Annual CSP Workshop on ``Recent Developments in Computer Simulation Studies in Condensed Matter Physics'', CSP 2015}
%% Use \dochead if there is an article header, e.g. \dochead{Short communication}
%% \dochead can also be used to include a conference title, if directed by the editors
%% e.g. \dochead{17th International Conference on Dynamical Processes in Excited States of Solids}

\title{OpenDF - a multiscale method for strongly correlated systems }

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}



\author[a]{Andrey E. Antipov\corref{cor1}} 
\author[a]{James P.F. LeBlanc}
\author[a]{Emanuel Gull}

\address[a]{Department of Physics, University of Michigan, Ann Arbor, Michigan 48109, USA}

\begin{abstract}
We present the open-source algorithm, \textbf{opendf} code -  a multiscale approach, that utilizes recently developed dual fermion method, to solve lattice problems of interacting strongly correlated systems. In particular, present distribution of the code provides an approximate solution for the Hubbard model in various dimensions $d=1,2,3,4$. The method is designed to be the ending step of the self-consistency procedure of dynamical mean field theory (DMFT) and hence utilizes the DMFT input: Green's function and full reducible vertex functions. As an output the code provides an estimate to spatially dependent susceptibilities and Green's functions of the model. The code is distributed as an open-source package. 
\end{abstract}

\begin{keyword}
Type your keywords here, separated by semicolons ; 

%% keywords here, in the form: keyword \sep keyword

%% PACS codes here, in the form: \PACS code \sep code

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)

\end{keyword}
\cortext[cor1]{Corresponding author.}
\end{frontmatter}

%\correspondingauthor[*]{Corresponding author. Tel.: +0-000-000-0000 ; fax: +0-000-000-0000.}
\email{aantipov@umich.edu}

%%
%% Start line numbering here if you want
%%
% \linenumbers

%% main text

%\enlargethispage{-7mm}
\vspace*{-8pt}
\section{Introduction}
Introduction 
\vspace{5em}
text
\section{Equations}
\subsection{Prerequisites}
%The dual fermion method embeds non-local correlations absent in the dynamical mean-field theory using a diagrammatic resummation. 
Consider a lattice fermionic model 
\begin{equation}
H = \sum_{k\sigma} (\varepsilon_k - \mu) c^\dagger_{k\sigma} c_{k\sigma} + \sum_i H^{\mathrm{int}} [c^\dagger_i, c_i],
\end{equation}
where index $\sigma$ labels the spin projection, $\varepsilon_k$ is the lattice dispersion relation and $k$ is the vector in the reciprocal space. 
$H^{\mathrm{int}}$ labels the local interaction on every site of the lattice and index $i$ labels every site on the lattice. 
The choice $H^{\mathrm{int}} = U c^\dagger_\uparrow c_\uparrow c^\dagger_\downarrow c_\downarrow$ is the Hubbard model [Hubbard1963]. 

At the first step, performed outside of this code \footnote{Present code can be used as a part of the self-consistent DMFT loop, but requires an external ``impurity solver''.}, an approximate solution of the model is obtained by means of the dynamical mean field theory[]. 
It provides an estimate for the local Green's function of the lattice problem as a  solution of the Anderson impurity model, embedded into a self-consistently determined hybridization. The imaginary time action of this ``impurity problem''  reads in terms of Grassmann variables $c$, $c^*$ as 
\begin{equation}
S^{\mathrm{A}} = \sum_{i\omega,\sigma} (i\omega + \mu - \Delta_{\omega\sigma}) c^*_{\omega\sigma} c_{\omega\sigma} + S^{\mathrm{int}},
\end{equation}
where $S^{int} = \int_0^\beta d\tau H^{\mathrm{int}} [c^\dagger_i(\tau), c_i(\tau)] $ is the interaction part of the action. 
Hybridization function $\Delta_{\omega\sigma}$ can be obtained in a standard way [DMFT Review], present implementation of the code does not require a particular choice of frequency dependence of $\Delta$. 
The correlators of the Anderson impurity model: one particle Green's function $g_{\omega\sigma} = -\langle c_{\omega\sigma} c^*_{\omega\sigma} \rangle$ and the two particle full vertex function (connected parts of two-particle Green's functions)  
\begin{equation}
\gamma_{\Omega\omega\omega'}^{\sigma_1\sigma_2\sigma_3\sigma_4} = \left(\langle c_{\omega,\sigma_1} c^*_{\Omega + \omega,\sigma_2} c_{\omega' + \Omega, \sigma_3} c^*_{\omega', \sigma_4}\rangle - g_{\omega\sigma_1}g_{\omega'\sigma_3}\delta_{\Omega,0}\delta_{\sigma_1,\sigma_2} + g_{\omega\sigma_1} g_{\omega + \Omega, \sigma_2} \delta_{\omega,\omega'}\delta_{\sigma, \sigma_3} \right)
\end{equation}
are the input to DF calculations. 

Presented version of the code considers spin-symmetric solutions of the lattice $s=1/2$ fermionic problems, and does not describe symmetry-broken phases. We will omit index $\sigma$ from now on, unless it is specifically required. The complete set of input quantities reads
\begin{itemize}
\item $g_\omega$ - the full Green's function of the DMFT impurity problem (same values for both spin components)
\item $\Delta_{\omega}$ - hybridization function of the DMFT impurity problem
\item $\mu$ - chemical potential of the problem
\item Two independent components of the impurity vertex function: $\gamma^{\uparrow\uparrow}_{\Omega,\omega,\omega'} = \gamma_{\Omega,\omega,\omega'}^{\uparrow\uparrow\uparrow\uparrow}$ and $\gamma^{\uparrow\downarrow}_{\Omega,\omega,\omega'} = \gamma_{\Omega,\omega,\omega'}^{\uparrow\downarrow\downarrow\uparrow}$
\item Lattice dispersion $\varepsilon_{k}$ and the dimensionality $d$ are compiled into the specific running executable. The hypercubic lattice dispersion $-2t \sum_{i=1}^d \cos k_i$ at dimensions $d=1,2,3,4$ is provided with the code. Other lattice choices can be achieved by extending the code. 
\end{itemize}

\subsection{Ladder dual fermion self-consistency loop}
The evaluation of the DF equations consists of iterative solution to the fully dressed dual fermion Green's function $\tilde G$. It starts with the construction of the bare dual fermion propagator
\begin{equation}
\tilde G^{(0)}_{\omega,k} = \left[g_{\omega}^{-1} + \Delta_\omega - \varepsilon_k\right]^{-1} - g_{\omega}, \label{eq:gd0}
\end{equation}
which represents a $k$-dependent correction to the impurity Green's function.

This Green's function is used to construct bubbles: 
\begin{equation}\label{eq:dual_bubble}
\tilde \chi_{\Omega\omega}(q) = -T \int_{BZ} dk \tilde G_{\omega, k} \tilde G_{\omega + \Omega, k+q}.
\end{equation}
The impurity vertex functions are combined into density and magnetic channels (labeled d/m respectively) as: 
\begin{equation}\label{eq:spin_symm}
\gamma^{d/m}_{\Omega,\omega,\omega'} = \gamma^{\uparrow\uparrow}_{\Omega,\omega,\omega'} \pm \gamma^{\uparrow\downarrow}_{\Omega,\omega,\omega'}
\end{equation}
The vertices for the respected channels from Eq. \ref{eq:spin_symm} and the bubbles from Eq. \ref{eq:dual_bubble} are substituted into ladder equations:
\begin{equation}\label{eq:dual_ladder}
\Gamma^{d/m}_{\Omega,\omega,\omega'}(q) = \gamma^{d/m}_{\Omega,\omega,\omega'} + \sum_{\omega''} \gamma^{d/m}_{\Omega,\omega,\omega''} \tilde\chi_{\Omega,\omega''}(q) \Gamma^{d/m}_{\Omega'',\omega'}(q).
\end{equation}

Evaluation of Eq. \ref{eq:dual_ladder} is obtained independently for each pair of vertex bosonic frequency $\Omega$ and transferred momentum $q$. 
In this case $\gamma_{\Omega,\omega,\omega'}$ and $\Gamma_{\Omega,\omega,\omega'}(q)$ are matrices in the space of fermionic Matsubara frequencies $\omega$, $\omega'$, and $\tilde\chi_{\Omega,\omega''}(q)$ is a diagonal matrix. 
In the matrix notation for each $\Omega$ and $q$ this equation reads \begin{equation}\label{lin_alg_inv}
(\hat 1 - \hat \gamma \tilde \chi)\hat \Gamma  = \hat \gamma\end{equation} and is a standard linear algebra equation.
This equation is physically correct only when the maximum eigenvalue of $\hat \gamma \tilde \chi$ is smaller than one, i.e. all eigenvalues of the matrix $\hat D = \hat 1 - \hat \gamma \tilde \chi$ are positive. 
To determine it, an LU-decomposition of the matrix $\hat D$ is performed, and a determinant $D(\Omega, q)$ is calculated.
If $D(\Omega, q) > 0$, then $\Gamma$ is obtained at a constant computational complexity.
When $D(\Omega, q) \leq 0$, the DF solution is outside of the convergence radius of the ladder approximation.
Given that the resulting solution is unique, one can extend this convergence radius by doing a low-order iterative evaluation of $\Gamma$ and checking if the invertion of Eq. \ref{eq:dual_ladder} can be obtained on the next DF iteration. 

\andrey{TBD : SD equation}

\section{Implementation and examples}

\begin{figure}[ht]
\includegraphics[width=0.5\columnwidth]{time_bfreqs.pdf}
\caption{Bosonic scaling}
\end{figure}

\begin{figure}[ht]
\includegraphics[width=0.5\columnwidth]{time_ffreqs.pdf}
\caption{Fermionic scaling}
\end{figure}

\begin{figure}[ht]
\includegraphics[width=0.5\columnwidth]{time_kpts.pdf}
\caption{Volume scaling}
\end{figure}


\section{Conclusion}
text text text


\section*{Acknowledgements}
Acknowledgements 

\end{document}


